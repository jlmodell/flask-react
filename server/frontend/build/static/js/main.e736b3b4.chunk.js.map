{"version":3,"sources":["pages/Helen.js","pages/Bic.js","pages/Planning.js","pages/App.js","serviceWorker.js","index.js"],"names":["HelenFile","useState","date","setDate","file","setFile","email","setEmail","fname","setFname","useEffect","navigate","state","filename","handleSubmit","e","a","preventDefault","formData","FormData","xlFile","document","querySelector","set","append","files","config","headers","axios","post","response","data","result","console","log","style","container","helenFileCss","action","method","onSubmit","TextField","type","value","onChange","target","label","name","margin","InputLabelProps","shrink","required","fullWidth","variant","id","multiline","spacer","HelenSuccess","props","file_ext","useRef","location","download","responseType","get","blob","Blob","ref","current","href","URL","createObjectURL","click","display","onClick","flexDirection","justifyContent","alignItems","flexWrap","width","marginTop","marginBottom","now","Date","Bic","classes","useStyles","toISOString","substring","checked","setChecked","po","setPO","bicFile","setBicFile","loading","setLoading","excel","setExcel","bicXlFile","css","FormControlLabel","control","Checkbox","className","root","CircularProgress","size","BicSuccess","makeStyles","theme","marginLeft","spacing","Planning","html","setHtml","PlanningSuccess","Html","dangerouslySetInnerHTML","__html","Home","appBar","zIndex","drawer","flexShrink","drawerPaper","content","flexGrow","padding","toolbar","mixins","Boolean","window","hostname","match","ReactDOM","render","AppBar","position","Toolbar","Typography","noWrap","Drawer","paper","List","text","link","map","d","i","Fragment","key","ListItem","button","to","ListItemText","primary","Divider","path","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.e736b3b4.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { navigate } from \"@reach/router\";\r\nimport { TextField } from \"@material-ui/core\";\r\nimport axios from \"axios\";\r\n\r\nexport const HelenFile = () => {\r\n  const [date, setDate] = useState(\"2019-10-31\");\r\n  const [file, setFile] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [fname, setFname] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (fname) {\r\n      navigate(\"/helen_success\", { state: { filename: fname } });\r\n    }\r\n  }, [fname]);\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n\r\n    let formData = new FormData();\r\n\r\n    let xlFile = document.querySelector(\"#file\");\r\n\r\n    formData.set(\"date\", date);\r\n    formData.set(\"email\", email);\r\n    formData.append(\"file\", xlFile.files[0]);\r\n\r\n    let config = {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\"\r\n      }\r\n    };\r\n\r\n    try {\r\n      // let response = await axios.get(\"/api/helen_file\");\r\n      let response = await axios.post(\"api/helen_file\", formData, config);\r\n      setFname(response.data.result);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={container}>\r\n      <form\r\n        style={helenFileCss}\r\n        action=\"/helen_success\"\r\n        method=\"POST\"\r\n        // encType=\"multipart/form-data\"\r\n        onSubmit={handleSubmit}\r\n      >\r\n        <TextField\r\n          type=\"date\"\r\n          // defaultValue=\"2019-10-31\"\r\n          value={date}\r\n          onChange={e => setDate(e.target.value)}\r\n          label=\"Date\"\r\n          name=\"date\"\r\n          margin=\"normal\"\r\n          InputLabelProps={{ shrink: true }}\r\n          required={true}\r\n          fullWidth\r\n          variant=\"outlined\"\r\n        />\r\n        <TextField\r\n          type=\"file\"\r\n          id=\"file\"\r\n          label=\"File\"\r\n          name=\"file\"\r\n          value={file}\r\n          onChange={e => setFile(e.target.value)}\r\n          margin=\"normal\"\r\n          required={true}\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          InputLabelProps={{ shrink: true }}\r\n        />\r\n        <TextField\r\n          type=\"text\"\r\n          multiline\r\n          label=\"Email(s) 'comma' to separate.(optional)\"\r\n          name=\"email\"\r\n          value={email}\r\n          onChange={e => setEmail(e.target.value)}\r\n          margin=\"normal\"\r\n          fullWidth\r\n          variant=\"outlined\"\r\n          InputLabelProps={{ shrink: true }}\r\n        />\r\n        <div style={spacer}></div>\r\n        <TextField type=\"submit\" fullWidth variant=\"outlined\" />\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const HelenSuccess = props => {\r\n  const file_ext = useRef();\r\n\r\n  let filename = props.location.state.filename || \"test.xlsx\";\r\n\r\n  const download = async () => {\r\n    let responseType = {\r\n      responseType: \"arraybuffer\"\r\n    };\r\n\r\n    try {\r\n      let response = await axios.get(\"/download/\" + filename, responseType);\r\n      let blob = new Blob([response.data], {\r\n        type: response.headers[\"content-type\"]\r\n      });\r\n      let ref = file_ext;\r\n      ref.current.href = URL.createObjectURL(blob);\r\n      ref.current.download = filename;\r\n      ref.current.click();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={container}>\r\n      <h1>Success {filename}</h1>\r\n      <div>\r\n        <p>\r\n          Download file:{\" \"}\r\n          <a style={{ display: \"none\" }} href=\"empty\" ref={file_ext}>\r\n            ref\r\n          </a>\r\n          <button onClick={download}>{filename}</button>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst container = {\r\n  margin: \"2rem\",\r\n  display: \"flex\",\r\n  flexDirection: \"column\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\"\r\n};\r\nconst helenFileCss = {\r\n  display: \"flex\",\r\n  flexWrap: \"wrap\",\r\n  flexDirection: \"column\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\",\r\n  width: \"80%\"\r\n};\r\nconst spacer = {\r\n  marginTop: \"1rem\",\r\n  marginBottom: \"1rem\"\r\n};\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { navigate } from \"@reach/router\";\r\nimport { TextField, Checkbox, FormControlLabel } from \"@material-ui/core\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport axios from \"axios\";\r\n\r\nlet now = new Date();\r\n\r\nexport const Bic = () => {\r\n  const classes = useStyles();\r\n  const [date, setDate] = useState(now.toISOString().substring(0, 10));\r\n  const [checked, setChecked] = useState(false);\r\n  const [po, setPO] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [file, setFile] = useState(\"\");\r\n  const [bicFile, setBicFile] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [excel, setExcel] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (excel) {\r\n      console.log(excel);\r\n      navigate(\"/bic_success\", { state: { filename: excel } });\r\n    }\r\n  }, [excel]);\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n\r\n    setLoading(true);\r\n\r\n    let formData = new FormData();\r\n\r\n    formData.set(\"date\", date);\r\n    formData.set(\"po\", po);\r\n    formData.set(\"email\", email);\r\n    if (file) {\r\n      let xlFile = document.querySelector(\"#file\");\r\n      formData.append(\"file\", xlFile.files[0]);\r\n    }\r\n\r\n    if (bicFile) {\r\n      let bicXlFile = document.querySelector(\"#bicFile\");\r\n      formData.append(\"bicFile\", bicXlFile.files[0]);\r\n    }\r\n\r\n    let config = {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\"\r\n      }\r\n    };\r\n\r\n    try {\r\n      let response = await axios.post(\"api/bic\", formData, config);\r\n      setExcel(response.data.result);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      console.log(err);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={container}>\r\n      <form\r\n        style={css}\r\n        method=\"POST\"\r\n        action=\"/bic_success\"\r\n        onSubmit={handleSubmit}\r\n      >\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox checked={checked} onChange={() => setChecked(!checked)} />\r\n          }\r\n          label=\"Update BIC in Progress\"\r\n        />\r\n\r\n        <TextField\r\n          type=\"date\"\r\n          name=\"date\"\r\n          value={date}\r\n          onChange={e => setDate(e.target.value)}\r\n          variant=\"outlined\"\r\n          label=\"Date\"\r\n          required={true}\r\n          InputLabelProps={{ shrink: true }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <TextField\r\n          type=\"text\"\r\n          name=\"po\"\r\n          value={po}\r\n          onChange={e => setPO(e.target.value)}\r\n          variant=\"outlined\"\r\n          label=\"Purchase Order #\"\r\n          required={true}\r\n          InputLabelProps={{ shrink: true }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <TextField\r\n          type=\"file\"\r\n          name=\"file\"\r\n          id=\"file\"\r\n          value={file}\r\n          onChange={e => setFile(e.target.value)}\r\n          variant=\"outlined\"\r\n          label=\"Release Schedule.xls\"\r\n          required={true}\r\n          InputLabelProps={{ shrink: true }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        {checked && (\r\n          <TextField\r\n            type=\"file\"\r\n            name=\"bicFile\"\r\n            id=\"bicFile\"\r\n            value={bicFile}\r\n            onChange={e => setBicFile(e.target.value)}\r\n            variant=\"outlined\"\r\n            label=\"BIC File in Progress\"\r\n            InputLabelProps={{ shrink: true }}\r\n            fullWidth\r\n            margin=\"normal\"\r\n          />\r\n        )}\r\n        <TextField\r\n          type=\"text\"\r\n          name=\"email\"\r\n          value={email}\r\n          onChange={e => setEmail(e.target.value)}\r\n          variant=\"outlined\"\r\n          label=\"Email (optional) - separate with commas \"\r\n          InputLabelProps={{ shrink: true }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <div style={spacer} />\r\n        {loading ? (\r\n          <div className={classes.root}>\r\n            <CircularProgress size={60} />\r\n          </div>\r\n        ) : (\r\n          <TextField type=\"submit\" fullWidth variant=\"outlined\" />\r\n        )}\r\n\r\n        <div style={spacer} />\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const BicSuccess = props => {\r\n  const file_ext = useRef();\r\n\r\n  let filename = props.location.state.filename || \"test.xlsx\";\r\n\r\n  const download = async () => {\r\n    let responseType = {\r\n      responseType: \"arraybuffer\"\r\n    };\r\n\r\n    try {\r\n      let response = await axios.get(\"download/\" + filename, responseType);\r\n      let blob = new Blob([response.data], {\r\n        type: response.headers[\"content-type\"]\r\n      });\r\n      let ref = file_ext;\r\n      ref.current.href = URL.createObjectURL(blob);\r\n      ref.current.download = filename;\r\n      ref.current.click();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={container}>\r\n      <h1>Success {filename}</h1>\r\n      <div>\r\n        <p>\r\n          Download file:{\" \"}\r\n          <a style={{ display: \"none\" }} href=\"empty\" ref={file_ext}>\r\n            ref\r\n          </a>\r\n          <button onClick={download}>{filename}</button>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst container = {\r\n  margin: \"2rem\",\r\n  display: \"flex\",\r\n  flexDirection: \"column\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\"\r\n};\r\nconst css = {\r\n  display: \"flex\",\r\n  flexWrap: \"wrap\",\r\n  flexDirection: \"column\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\",\r\n  width: \"80%\"\r\n};\r\nconst spacer = {\r\n  marginTop: \"1rem\",\r\n  marginBottom: \"1rem\"\r\n};\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    display: \"flex\",\r\n    \"& > * + *\": {\r\n      marginLeft: theme.spacing(2)\r\n    }\r\n  }\r\n}));\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { navigate } from \"@reach/router\";\r\nimport { TextField } from \"@material-ui/core\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport axios from \"axios\";\r\n\r\nexport const Planning = () => {\r\n  const classes = useStyles();\r\n  const [file, setFile] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [email, setEmail] = useState(\"\");\r\n  const [excel, setExcel] = useState(\"\");\r\n  const [html, setHtml] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (excel) {\r\n      navigate(\"/planning_success\", { state: { filename: excel, html: html } });\r\n    }\r\n  }, [excel, html]);\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    let formData = new FormData();\r\n\r\n    let xlFile = document.querySelector(\"#file\");\r\n\r\n    formData.set(\"email\", email);\r\n    formData.append(\"file\", xlFile.files[0]);\r\n\r\n    let config = {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\"\r\n      }\r\n    };\r\n\r\n    try {\r\n      let response = await axios.post(\"/api/planning\", formData, config);\r\n      setExcel(response.data.result);\r\n      setHtml(response.data.html);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      console.log(err);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={container}>\r\n      <form\r\n        style={css}\r\n        method=\"POST\"\r\n        action=\"/planning_success\"\r\n        onSubmit={handleSubmit}\r\n      >\r\n        <TextField\r\n          type=\"file\"\r\n          name=\"file\"\r\n          id=\"file\"\r\n          value={file}\r\n          onChange={e => setFile(e.target.value)}\r\n          variant=\"outlined\"\r\n          label=\"planningsocustkit.csv *no headers*\"\r\n          required={true}\r\n          InputLabelProps={{ shrink: true }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <TextField\r\n          type=\"text\"\r\n          name=\"email\"\r\n          value={email}\r\n          onChange={e => setEmail(e.target.value)}\r\n          variant=\"outlined\"\r\n          label=\"Email (optional) - separate with commas \"\r\n          InputLabelProps={{ shrink: true }}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <div style={spacer} />\r\n        {loading ? (\r\n          <div className={classes.root}>\r\n            <CircularProgress size={60} />\r\n          </div>\r\n        ) : (\r\n          <TextField type=\"submit\" fullWidth variant=\"outlined\" />\r\n        )}\r\n\r\n        <div style={spacer} />\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const PlanningSuccess = props => {\r\n  const file_ext = useRef();\r\n\r\n  let filename = props.location.state.filename || \"test.xlsx\";\r\n  const Html = props.location.state.html;\r\n\r\n  const download = async () => {\r\n    let responseType = {\r\n      responseType: \"arraybuffer\"\r\n    };\r\n\r\n    try {\r\n      let response = await axios.get(\"download/\" + filename, responseType);\r\n      let blob = new Blob([response.data], {\r\n        type: response.headers[\"content-type\"]\r\n      });\r\n      let ref = file_ext;\r\n      ref.current.href = URL.createObjectURL(blob);\r\n      ref.current.download = filename;\r\n      ref.current.click();\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={container}>\r\n      <h1>Success {filename}</h1>\r\n      <div>\r\n        <p>\r\n          Download file:{\" \"}\r\n          <a style={{ display: \"none\" }} href=\"empty\" ref={file_ext}>\r\n            ref\r\n          </a>\r\n          <button onClick={download}>{filename}</button>\r\n        </p>\r\n        <div dangerouslySetInnerHTML={{ __html: Html }} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst container = {\r\n  margin: \"2rem\",\r\n  display: \"flex\",\r\n  flexDirection: \"column\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\"\r\n};\r\nconst css = {\r\n  display: \"flex\",\r\n  flexWrap: \"wrap\",\r\n  flexDirection: \"column\",\r\n  justifyContent: \"center\",\r\n  alignItems: \"center\",\r\n  width: \"80%\"\r\n};\r\nconst spacer = {\r\n  marginTop: \"1rem\",\r\n  marginBottom: \"1rem\"\r\n};\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    display: \"flex\",\r\n    \"& > * + *\": {\r\n      marginLeft: theme.spacing(2)\r\n    }\r\n  }\r\n}));\r\n","import React from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport {\r\n  AppBar,\r\n  Toolbar,\r\n  Drawer,\r\n  Typography,\r\n  List,\r\n  Divider,\r\n  ListItem,\r\n  ListItemText\r\n} from \"@material-ui/core/\";\r\nimport { Link, Router } from \"@reach/router\";\r\nimport { HelenFile, HelenSuccess } from \"./Helen\";\r\nimport { Bic, BicSuccess } from \"./Bic\";\r\nimport { Planning, PlanningSuccess } from \"./Planning\";\r\n\r\nconst drawerWidth = 240;\r\n\r\nexport const App = () => {\r\n  const classes = useStyles();\r\n  const drawerItems = [\r\n    { text: \"Home\", link: \"/\" },\r\n    { text: \"Helen 6417R1 File\", link: \"helen\" },\r\n    { text: \"BIC Form Packer\", link: \"bic\" },\r\n    { text: \"Heber Planning Function\", link: \"planning\" }\r\n  ];\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div>\r\n        <AppBar className={classes.appBar} position=\"fixed\">\r\n          <Toolbar>\r\n            <Typography variant=\"h6\" noWrap>\r\n              <strong>Busse</strong> Hospital Disposables |{\" \"}\r\n              <i>Internal Functions</i>\r\n            </Typography>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <Drawer\r\n          className={classes.drawer}\r\n          variant=\"permanent\"\r\n          classes={{\r\n            paper: classes.drawerPaper\r\n          }}\r\n        >\r\n          <div className={classes.toolbar} />\r\n          <List>\r\n            {drawerItems.map((d, i) => (\r\n              <React.Fragment key={d.text + \"-\" + i}>\r\n                <ListItem button key={d.text}>\r\n                  <Link to={d.link}>\r\n                    <ListItemText primary={d.text} />\r\n                  </Link>\r\n                </ListItem>\r\n                <Divider key={i} />\r\n              </React.Fragment>\r\n            ))}\r\n          </List>\r\n        </Drawer>\r\n      </div>\r\n\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        <Router>\r\n          <Home path=\"/\" />\r\n          <HelenFile path=\"helen\" />\r\n          <HelenSuccess path=\"helen_success\" />\r\n          <Bic path=\"bic\" />\r\n          <BicSuccess path=\"bic_success\" />\r\n          <Planning path=\"planning\" />\r\n          <PlanningSuccess path=\"planning_success\" />\r\n        </Router>\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Home = () => (\r\n  <div>\r\n    <h1>Welcome</h1>\r\n  </div>\r\n);\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    display: \"flex\"\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0\r\n  },\r\n  drawerPaper: {\r\n    width: drawerWidth\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3)\r\n  },\r\n  toolbar: theme.mixins.toolbar\r\n}));\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport { App } from \"./pages/App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}